
<app-custom-popup [width]="settingsServ.isMobileView ? '90vw' : '570px'" 
    (onClose)="onCloseProPic()" 
    [closeOnClickAway]="showCloseButton"
    [showCloseButton]="showCloseButton">
    @if (savingChanges){
        <div class="centered loading-spaced">
            <app-loading-spinner width="40px" height="40px"></app-loading-spinner>
        </div>
    } @else{
        @if(isSelectingNewProPic){
            <div class="centered middle">
                <app-custom-picture-viewer
                    [imgSrc]="tempProPicUrl !== '' ? tempProPicUrl : (proPicUrl !== '' ? proPicUrl : '/assets/DefaultProPic.png')"
                    (onCloseView)="getLatestTransform($event)">
                </app-custom-picture-viewer>
            </div>
        } @else if(isEditingProPic){
            @if(tempProPicToCropUrl !== ''){
                 <div class="cropper-frame">
                    <app-custom-cropper
                        [startingTransform]="latestTransform"
                        (onCropped)="uploadCroppedProPic($event)"
                        (onCanceled)="onConfirmCancelPhotoCrop()"
                        [imgSrc]="tempProPicToCropUrl"></app-custom-cropper>
                 </div>
            } @else {
                <div class="centered loading-spaced">
                    <app-loading-spinner width="40px" height="40px"></app-loading-spinner>
                </div>
            }
        } @else {
            <div class="centered middle">
                <!-- [startingTransform]="latestTransform" -->
                <app-custom-picture-viewer
                    [imgSrc]="tempProPicUrl !== '' ? tempProPicUrl : (proPicUrl !== '' ? proPicUrl : '/assets/DefaultProPic.png')"
                    (onCloseView)="getLatestTransform($event)">
                </app-custom-picture-viewer>
            </div>
        }
    }
    @if(isEditingProPic){
        @if(!isClearingUpload){
            <app-custom-upload [photoOnly]="true" 
                [showPreview]="true" 
                [allowCancel]="true"
                (onImageSelected)="setTempProPicUrl($event)"
                (onCancelUpload)="onConfirmCancelPhotoUpload()"
                (onSubmit)="updateProPic($event)" [showPreview]="false"></app-custom-upload>
        } @else {
            <div class="hold-upload-space"></div>
        }
    } @else {
        <div class="save-button-grid">
            <app-custom-button stylingMode="contained" (buttonClick)="onClickEditProPic()">
                Edit
            </app-custom-button>
        </div>
    }
</app-custom-popup>